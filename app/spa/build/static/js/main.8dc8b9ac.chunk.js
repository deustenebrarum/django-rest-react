(this.webpackJsonpspa=this.webpackJsonpspa||[]).push([[0],{253:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(34),o=n.n(a),c=n(46),i=n(40),s=n(31),l=n(24),u=n(65),j=n(30),d=n.n(j),p=n(258),b=n(260),h=n(262),f=n(263),x=n(264),O=n(5),m=function(e){return Object(O.jsx)(p.b,{itemLayout:"vertical",size:"large",pagination:{onChange:function(e){console.log(e)},pageSize:3},dataSource:e.data,renderItem:function(e){return Object(O.jsxs)(p.b.Item,{actions:[Object(O.jsx)(h.a,{text:"156"}),Object(O.jsx)(f.a,{type:"like-o",text:"156"}),Object(O.jsx)(x.a,{type:"message",text:"2"})],extra:Object(O.jsx)("img",{width:272,alt:"logo",src:"https://gw.alipayobjects.com/zos/rmsportal/mqaQswcyDLcXyDKnZfES.png"}),children:[Object(O.jsx)(p.b.Item.Meta,{avatar:Object(O.jsx)(b.a,{src:e.avatar}),title:Object(O.jsxs)("a",{href:"/articles/".concat(e.id),children:[" ",e.title," "]}),description:e.description}),e.content]},e.title)}})},g=n(118),v=n.n(g),y=n(146),w=n(256),k=n(259),T=n(72),S=function(e,t){return Object(c.a)(Object(c.a)({},e),t)},D="http://127.0.0.1/",I=w.a.Item;var A=Object(s.b)((function(e){return{token:e.token}}))((function(e){var t=this,n=function(){var t=Object(y.a)(v.a.mark((function t(n,r,a){var o;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),o={title:n.target.elements.title.value,content:n.target.elements.content.value},d.a.defaults.xsrfHeaderName="X-CSRFTOKEN",d.a.defaults.xsrfCookieName="csrftoken",d.a.defaults.headers={"Content-Type":"application/json",Authorization:"Token ".concat(e.token)},"post"!==r){t.next=10;break}return t.next=8,d.a.post(D+"api/create/",o).then((function(t){201===t.status&&e.history.push("/")}));case 8:t.next=13;break;case 10:if("put"!==r){t.next=13;break}return t.next=13,d.a.put(D+"api/".concat(a,"/update/"),o).then((function(t){200===t.status&&e.history.push("/")}));case 13:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}();return Object(O.jsx)("div",{children:Object(O.jsxs)(w.a,{onSubmit:function(e){return n(e,t.props.requestType,t.props.articleID)},children:[Object(O.jsx)(I,{label:"Title",children:Object(O.jsx)(k.a,{name:"title",placeholder:"Put a title here"})}),Object(O.jsx)(I,{label:"Content",children:Object(O.jsx)(k.a,{name:"content",placeholder:"Enter some content ..."})}),Object(O.jsx)(I,{children:Object(O.jsx)(T.a,{type:"primary",htmlType:"submit",children:e.btnText})})]})})}));var E=function(e){var t=Object(r.useState)([]),n=Object(u.a)(t,2),a=n[0],o=n[1],c=function(){d.a.get(D+"api/").then((function(e){o(e.data)}))};return Object(r.useEffect)((function(){c()}),[]),Object(r.useEffect)((function(){c()}),[e.token]),Object(O.jsxs)("div",{children:[Object(O.jsx)(m,{data:a})," ",Object(O.jsx)("br",{}),Object(O.jsx)("h2",{children:" Create an article "}),Object(O.jsx)(A,{requestType:"post",articleID:null,btnText:"Create"})]})},C=n(257);var N=Object(s.b)((function(e){return{token:e.token}}))((function(e){var t=Object(r.useState)({}),n=Object(u.a)(t,2),a=n[0],o=n[1],i=e.match.params.articleID;return Object(r.useEffect)((function(){d.a.get(D+"api/".concat(i)).then((function(e){o(e.data)}))}),[i]),Object(O.jsxs)("div",{children:[Object(O.jsx)(C.a,{title:a.title,children:Object(O.jsxs)("p",{children:[" ",a.content," "]})}),Object(O.jsx)(A,Object(c.a)(Object(c.a)({},e),{},{token:e.token,requestType:"put",articleID:e.match.params.articleID,btnText:"Update"})),Object(O.jsx)("form",{onSubmit:function(t){t.preventDefault();var n=e.match.params.articleID;d.a.defaults.headers={"Content-Type":"application/json",Authorization:"Token ".concat(e.token)},d.a.delete(D+"api/".concat(n,"/delete/")).then((function(t){204===t.status&&e.history.push("/")}))},children:Object(O.jsx)(T.a,{type:"danger",htmlType:"submit",children:"Delete"})})]})})),P=n(55),U=n(265),L=n(266),_="AUTH_START",q="AUTH_SUCCESS",F="AUTH_FAIL",H="AUTH_LOGOUT",R=function(){return{type:_}},z=function(e){return{type:q,token:e}},W=function(e){return{type:F,error:e}},X=function(){return localStorage.removeItem("token"),localStorage.removeItem("expirationDate"),{type:H}},B=function(e){return function(t){setTimeout((function(){t(X())}),1e3*e)}},K=void 0,J=w.a.Item,M=Object(O.jsx)(P.a,{spin:!0,style:{fontSize:24}}),Q=function(e){e.preventDefault(),K.props.form.validateFields((function(e,t){e||(K.props.onAuth(t.userName,t.password),K.props.history.push("/"))}))};var V=w.a.create()((function(e){var t=null;e.error&&(t=Object(O.jsx)("p",{children:e.error.message}));var n=e.form.getFieldDecorator;return Object(O.jsxs)("div",{children:[t,this.props.loading?Object(O.jsx)(P.a,{spin:!0,indicator:M}):Object(O.jsxs)(w.a,{onSubmit:Q,className:"login-form",children:[Object(O.jsx)(J,{children:n("userName",{rules:[{required:!0,message:"Please input your username!"}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(U.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))}),Object(O.jsx)(J,{children:n("password",{rules:[{required:!0,message:"Please input your Password!"}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(L.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))}),Object(O.jsxs)(J,{children:[Object(O.jsx)(T.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"},children:"Login"}),"Or",Object(O.jsx)(i.c,{style:{marginRight:"10px"},to:"/signup/",children:" signup"})]})]})]})})),G=Object(s.b)((function(e){return{loading:e.loading,error:e.error}}),(function(e){return{onAuth:function(t,n){return e(function(e,t){return function(n){n(R()),d.a.post(D+"rest-auth/login/",{username:e,password:t}).then((function(e){var t=e.data.key,r=new Date((new Date).getTime()+36e5);localStorage.setItem("token",t),localStorage.setItem("expirationDate",r),n(z(t)),n(B(3600))})).catch((function(e){n(W(e))}))}}(t,n))}}}))(V),Z=n(267),$=w.a.Item;var Y=w.a.create()((function(e){var t=this,n=Object(r.useState)(!1),a=Object(u.a)(n,2),o=a[0],c=a[1],s=e.form.getFieldDecorator;return Object(O.jsxs)(w.a,{onSubmit:function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll((function(e,n){e||(t.props.onAuth(n.userName,n.email,n.password,n.confirm),t.props.history.push("/"))}))},children:[Object(O.jsx)($,{children:s("userName",{rules:[{required:!0,message:"Please input your username!"}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(U.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))}),Object(O.jsx)($,{children:s("email",{rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(Z.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email"}))}),Object(O.jsx)($,{children:s("password",{rules:[{required:!0,message:"Please input your password!"},{validator:function(t,n,r){var a=e.form;n&&o&&a.validateFields(["confirm"],{force:!0}),r()}}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(L.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))}),Object(O.jsx)($,{children:s("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:function(t,n,r){var a=e.form;n&&n!==a.getFieldValue("password")?r("Two passwords that you enter is inconsistent!"):r()}}]})(Object(O.jsx)(k.a,{prefix:Object(O.jsx)(L.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onBlur:function(e){var t=e.target.value;c(o||!!t)}}))}),Object(O.jsxs)($,{children:[Object(O.jsx)(T.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"},children:"Signup"}),"Or",Object(O.jsx)(i.c,{style:{marginRight:"10px"},to:"/login/",children:" login"})]})]})})),ee=Object(s.b)((function(e){return{loading:e.loading,error:e.error}}),(function(e){return{onAuth:function(t,n,r,a){return e(function(e,t,n,r){return function(a){a(R()),d.a.post(D+"rest-auth/registration/",{username:e,email:t,password1:n,password2:r}).then((function(e){var t=e.data.key,n=new Date((new Date).getTime()+36e5);localStorage.setItem("token",t),localStorage.setItem("expirationDate",n),a(z(t)),a(B(3600))})).catch((function(e){a(W(e))}))}}(t,n,r,a))}}}))(Y),te=function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)(l.a,{exact:!0,path:"/",component:E})," ",Object(O.jsx)(l.a,{exact:!0,path:"/articles/:articleID/",component:N})," ",Object(O.jsx)(l.a,{exact:!0,path:"/login/",component:G})," ",Object(O.jsx)(l.a,{exact:!0,path:"/signup/",component:ee})," "]})},ne=n(255),re=n(120),ae=n(261),oe=ne.a.Header,ce=ne.a.Content,ie=ne.a.Footer;var se=Object(l.e)(Object(s.b)(null,(function(e){return{logout:function(){return e(X())}}}))((function(e){return Object(O.jsxs)(ne.a,{className:"layout",children:[Object(O.jsxs)(oe,{children:[Object(O.jsx)("div",{className:"logo"}),Object(O.jsxs)(re.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],style:{lineHeight:"64px"},children:[e.isAuthenticated?Object(O.jsx)(re.a.Item,{onClick:e.logout,children:"Logout"},"2"):Object(O.jsx)(re.a.Item,{children:Object(O.jsx)(i.b,{to:"/login",children:"Login"})},"2"),Object(O.jsx)(re.a.Item,{children:Object(O.jsx)(i.b,{to:"/",children:"Posts"})},"1")]})]}),Object(O.jsxs)(ce,{style:{padding:"0 50px"},children:[Object(O.jsxs)(ae.a,{style:{margin:"16px 0"},children:[Object(O.jsx)(ae.a.Item,{children:Object(O.jsx)(i.b,{to:"/",children:"Home"})}),Object(O.jsx)(ae.a.Item,{children:Object(O.jsx)(i.b,{to:"/",children:"List"})})]}),Object(O.jsx)("div",{style:{background:"#fff",padding:24,minHeight:280},children:e.children})]}),Object(O.jsx)(ie,{style:{textAlign:"center"},children:"Ant Design \xa92016 Created by Ant UED"})]})})));var le=Object(s.b)((function(e){return{isAuthenticated:null!==e.token}}),(function(e){return{onTryAutoSignup:function(){return e((function(e){var t=localStorage.getItem("token");if(void 0===t)e(X());else{var n=new Date(localStorage.getItem("expirationDate"));n<=new Date?e(X()):(e(z(t)),e(B((n.getTime()-(new Date).getTime())/1e3)))}}))}}}))((function(e){return Object(r.useEffect)((function(){e.onTryAutoSignup()})),Object(O.jsx)("div",{children:Object(O.jsx)(i.a,{children:Object(O.jsx)(se,Object(c.a)(Object(c.a)({},e),{},{children:Object(O.jsx)(te,{})}))})})})),ue=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function je(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var de=n(107),pe=n(149),be={token:null,error:null,loading:!1},he=function(e,t){return S(e,{error:null,loading:!0})},fe=function(e,t){return S(e,{token:t.token,error:null,loading:!1})},xe=function(e,t){return S(e,{error:t.error,loading:!1})},Oe=function(e,t){return S(e,{token:null})},me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return he(e);case q:return fe(e,t);case F:return xe(e,t);case H:return Oe(e);default:return e}},ge=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||de.b,ve=Object(de.c)(me,ge(Object(de.a)(pe.a))),ye=Object(O.jsx)(s.a,{store:ve,children:Object(O.jsx)(le,{})});o.a.render(ye,document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");ue?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):je(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):je(e)}))}}()}},[[253,1,2]]]);
//# sourceMappingURL=main.8dc8b9ac.chunk.js.map